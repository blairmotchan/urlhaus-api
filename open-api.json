{"openapi":"3.0.1","info":{"title":"Malware Url API","description":"API for searching for \"sketchy\" websites delivering nefarious content, limited to online threats","version":"1"},"servers":[{"url":"http://localhost:8080/","description":"Generated server url"}],"paths":{"/malware-urls/v1":{"get":{"tags":["malware-url-controller"],"description":"Standard endpoint to iterate through all urls","operationId":"get","parameters":[{"name":"page","in":"query","description":"Page of data to retrieve starting at 0","required":false,"schema":{"type":"integer","format":"int32","default":0}},{"name":"size","in":"query","description":"Number or results to return in the response","required":false,"schema":{"type":"integer","format":"int32","default":20}}],"responses":{"200":{"description":"Successful retrieval of data","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/MalwareUrl"}}}}}}}},"/malware-urls/v1/tag":{"get":{"tags":["malware-url-controller"],"description":"Endpoint to find all URLs that have the specified tag","operationId":"searchByTag","parameters":[{"name":"page","in":"query","description":"Page of data to retrieve starting at 0","required":false,"schema":{"type":"integer","format":"int32","default":0}},{"name":"size","in":"query","description":"Number or results to return in the response. Default is 20.","required":false,"schema":{"type":"integer","format":"int32","default":20}},{"name":"tag","in":"query","description":"Tag to search for","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"Successful retrieval of data","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/MalwareUrl"}}}}}}}},"/malware-urls/v1/nearest-neighbors":{"get":{"tags":["malware-url-controller"],"description":"Endpoint to find the closet URLs to the provided latitude and longitude","operationId":"findNearestNeighbors","parameters":[{"name":"page","in":"query","description":"Page of data to retrieve starting at 0","required":false,"schema":{"type":"integer","format":"int32","default":0}},{"name":"size","in":"query","description":"Number or results to return in the response. Default is 20.","required":false,"schema":{"type":"integer","format":"int32","default":20}},{"name":"longitude","in":"query","description":"Longitude position","required":true,"schema":{"type":"number","format":"double"}},{"name":"latitude","in":"query","description":"Latitude position","required":true,"schema":{"type":"number","format":"double"}}],"responses":{"200":{"description":"Successful retrieval of data","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/MalwareUrlDistance"}}}}}}}}},"components":{"schemas":{"MalwareUrl":{"type":"object","properties":{"id":{"type":"integer","description":"Database identifier","format":"int64"},"dateAdded":{"type":"string","description":"Date added to urlhaus database","format":"date-time"},"url":{"type":"string","description":"Actual URL"},"urlStatus":{"type":"string","description":"Online/Offline descriptor"},"threat":{"type":"string","description":"Type of threat the URL poses"},"tags":{"type":"array","description":"Tags associated with the URL","items":{"type":"string","description":"Tags associated with the URL"}},"urlHausLink":{"type":"string","description":"https://urlhaus.abuse.ch/api/ link for more information"},"reporter":{"type":"string","description":"Reporter of the URL"},"country":{"type":"string","description":"Estimated Country of the URL"},"city":{"type":"string","description":"Estimated City of the URL"},"latitude":{"type":"number","description":"Estimated latitude of the URL","format":"double"},"longitude":{"type":"number","description":"Estimated longitude of the URL","format":"double"}}},"MalwareUrlDistance":{"type":"object","properties":{"id":{"type":"integer","description":"Database identifier","format":"int64"},"dateAdded":{"type":"string","description":"Date added to urlhaus database","format":"date-time"},"url":{"type":"string","description":"Actual URL"},"urlStatus":{"type":"string","description":"Online/Offline descriptor"},"threat":{"type":"string","description":"Type of threat the URL poses"},"tags":{"type":"array","description":"Tags associated with the URL","items":{"type":"string","description":"Tags associated with the URL"}},"urlHausLink":{"type":"string","description":"https://urlhaus.abuse.ch/api/ link for more information"},"reporter":{"type":"string","description":"Reporter of the URL"},"country":{"type":"string","description":"Estimated Country of the URL"},"city":{"type":"string","description":"Estimated City of the URL"},"latitude":{"type":"number","description":"Estimated latitude of the URL","format":"double"},"longitude":{"type":"number","description":"Estimated longitude of the URL","format":"double"},"distance":{"type":"number","description":"Estimated distance from the search point","format":"double"}}}}}}