package com.blair.urlhaus.controller;

import com.blair.urlhaus.domain.MalwareUrl;
import com.blair.urlhaus.service.MalwareUrlService;
import io.swagger.v3.oas.annotations.OpenAPIDefinition;
import io.swagger.v3.oas.annotations.Operation;
import io.swagger.v3.oas.annotations.Parameter;
import io.swagger.v3.oas.annotations.enums.ParameterIn;
import io.swagger.v3.oas.annotations.info.Info;
import io.swagger.v3.oas.annotations.responses.ApiResponse;
import io.swagger.v3.oas.annotations.responses.ApiResponses;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.RestController;

import java.util.List;

@RestController
@RequestMapping("/malware-urls/v1")
@OpenAPIDefinition(
        info = @Info(
                title = "Malware Url API",
                description = "API for searching for \"sketchy\" websites delivering nefarious content, limited to online threats",
                version = "1"
        )
)
public class MalwareUrlController {
    private MalwareUrlService malwareUrlService;

    public MalwareUrlController(MalwareUrlService malwareUrlService) {
        this.malwareUrlService = malwareUrlService;
    }

    @GetMapping
    @Operation(
            description = "foobar",
            parameters = {
                    @Parameter(
                            name = "page",
                            description = "Page of data to retrieve starting at 0",
                            in = ParameterIn.QUERY
                    )
            }
    )
    @ApiResponses(
            @ApiResponse(
                    description = "Successful retrieval of data",
                    responseCode = "200"
            )
    )
    public List<MalwareUrl> get(
            @RequestParam(value = "page", defaultValue = "0") int page,
            @RequestParam(value = "size", defaultValue = "20") int size
    ) {
        return malwareUrlService.get(page, size);
    }
}
